(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{108:function(e,t){},126:function(e,t){},127:function(e,t){},128:function(e,t){},144:function(e,t){},152:function(e,t,n){},154:function(e,t,n){},156:function(e,t,n){},158:function(e,t,n){},162:function(e,t,n){},164:function(e,t,n){},166:function(e,t,n){},168:function(e,t,n){},170:function(e,t,n){},172:function(e,t,n){},174:function(e,t,n){},176:function(e,t,n){},178:function(e,t,n){},180:function(e,t,n){},182:function(e,t,n){},184:function(e,t,n){},186:function(e,t,n){},189:function(e,t,n){},191:function(e,t,n){},193:function(e,t,n){},195:function(e,t,n){},197:function(e,t,n){},199:function(e,t,n){},201:function(e,t,n){},203:function(e,t,n){},205:function(e,t,n){},207:function(e,t,n){},209:function(e,t,n){},211:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(23),s=n(9),u=n(4),c=n(3),i=n(7),o=n(5),p=n(6),l=n(216),h=n(218),f=n(1),d=n.n(f),v=n(2),m=n(67),b=n(214),w=function(e){function t(e){var n;return Object(u.a)(this,t),n=Object(i.a)(this,Object(o.a)(t).call(this,e||{})),e||n._unsafeAssignState(n.blank()),n.rebind(),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"update",value:function(){var e=Object(v.a)(d.a.mark(function e(n){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.a)(Object(o.a)(t.prototype),"update",this).call(this,n);case 2:this.rebind();case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"state",get:function(){return this.props}}]),t}(function(){function e(t){Object(u.a)(this,e),this.parent=void 0,this.props=void 0,this.error=void 0,this.updating=void 0,this.updateDepth=0,this.observer=new b.a,this.error=null,this.updating=!1,this.parent=null,this.props={},this._unsafeAssignState(t)}return Object(c.a)(e,[{key:"subscribe",value:function(e){var t=this.observer.subscribe(e);return function(){t.unsubscribe()}}},{key:"update",value:function(){var e=Object(v.a)(d.a.mark(function e(t){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._startUpdate(),e.prev=1,e.next=4,t();case 4:(n=e.sent)&&(this.props=Object(s.a)({},this.props,n)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),this.error=e.t0;case 11:this._completedUpdate();case 12:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t){return e.apply(this,arguments)}}()},{key:"_startUpdate",value:function(){this.updateDepth+=1,this.updating=!0,this.error=null,1===this.updateDepth&&this.observer.next(this),this.parent&&this.parent._startUpdate()}},{key:"_completedUpdate",value:function(){this.updateDepth-=1,0===this.updateDepth&&(this.updating=!1,this.parent&&this.parent._completedUpdate(),this.observer.next(this))}},{key:"_unsafeAssignState",value:function(t){if(t){this.props=t;try{for(var n=Object.entries(t),r=0;r<n.length;r++){var a=n[r];a[1]instanceof e&&(a[1].parent=this)}}catch(s){}}}}]),e}()),j=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"reset",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.blank());case 1:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{loggedIn:!1,permissions:[],username:"anonymous user"}}},{key:"rebind",value:function(){}}]),t}(w),O=(n(77),function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.createElement("div",{className:"component--LayoutTheme"},this.props.children)}}]),t}(r.Component)),k=(n(80),function(){function e(){Object(u.a)(this,e)}return Object(c.a)(e,[{key:"get",value:function(){var e=this.provide();if(!e)throw new Error("Provider not configured");return e}}]),e}()),y=new(function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this))).factory=e,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"configure",value:function(e){this.factory=e}},{key:"provide",value:function(){return null==this.factory?null:this.factory()}}]),t}(k))(null),x=n(66),g=function(e){function t(e,n){var r;return Object(u.a)(this,t),(r=Object(i.a)(this,Object(o.a)(t).call(this,e))).innerErrors={},r.innerErrors=n,r}return Object(p.a)(t,e),t}(Object(x.a)(Error)),E=function(){function e(t){Object(u.a)(this,e),this.rootUrl=t}return Object(c.a)(e,null,[{key:"serializeRequestBody",value:function(e){try{return JSON.stringify(e)}catch(n){var t=y.get();throw t.info("Unable to serialize object",e),t.error(n),new Error("Request failed: Unable to serialize object for POST")}}}]),Object(c.a)(e,[{key:"get",value:function(){var e=Object(v.a)(d.a.mark(function e(t){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this.rootUrl).concat(t),{method:"GET"});case 2:if((n=e.sent).ok){e.next=5;break}throw new Error(n.statusText);case 5:return e.abrupt("return",n.json());case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(){var t=Object(v.a)(d.a.mark(function t(n,r){var a,s,u,c;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=new Headers({Accept:"*/*","Content-Type":"application/json","X-Requested-With":"PANGUL"}),t.prev=1,s=e.serializeRequestBody(r),t.next=5,fetch("".concat(this.rootUrl).concat(n),{body:s,cache:"no-cache",credentials:"include",headers:a,method:"POST",mode:"cors",redirect:"follow"});case 5:if((u=t.sent).ok){t.next=17;break}return t.prev=7,t.next=10,u.json();case 10:return c=t.sent,t.abrupt("return",{error:new g(c.result,c.errors),success:!1});case 14:return t.prev=14,t.t0=t.catch(7),t.abrupt("return",{error:new Error("Request failed: ".concat(u.status,": ").concat(u.statusText)),success:!1});case 17:return t.next=19,u.json();case 19:return t.abrupt("return",t.sent);case 22:return t.prev=22,t.t1=t.catch(1),t.abrupt("return",{error:t.t1,success:!1});case 25:case"end":return t.stop()}},t,this,[[1,22],[7,14]])}));return function(e,n){return t.apply(this,arguments)}}()}]),e}(),q=function(){function e(){Object(u.a)(this,e)}return Object(c.a)(e,[{key:"error",value:function(e){e&&window.console.error(e)}},{key:"info",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];(t=window.console).log.apply(t,[e].concat(r))}}]),e}(),C=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this))).instance=e,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"configure",value:function(e){this.instance=e}},{key:"provide",value:function(){return this.instance}}]),t}(k),S=new C(null),I=new C(null);var N,T=function(){function e(){Object(u.a)(this,e)}return Object(c.a)(e,[{key:"post",value:function(){var e=Object(v.a)(d.a.mark(function e(t,n){var r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch.post(t,n);case 2:if(!(r=e.sent).success){e.next=5;break}return e.abrupt("return",r.data);case 5:if(this.logger.error(r),null==r.error){e.next=8;break}throw r.error;case 8:throw new Error("Internal server error");case 9:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"fetch",get:function(){return S.get()}},{key:"logger",get:function(){return y.get()}}]),e}(),D=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"login",value:function(){var e=Object(v.a)(d.a.mark(function e(t,n){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/auth/login",{username:t,password:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/auth/logout",null);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"claims",value:function(){var e=Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.post("/api/auth/claims",null));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}(T),P=function(){function e(){Object(u.a)(this,e),this.authController=void 0,this.authController=new D}return Object(c.a)(e,[{key:"login",value:function(){var e=Object(v.a)(d.a.mark(function e(t,n,r){var a=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.update(Object(v.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.authController.login(n,r);case 2:return e.next=4,a.authController.claims();case 4:return t=e.sent,e.abrupt("return",{loggedIn:!0,permissions:t.claims,username:t.token});case 6:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(v.a)(d.a.mark(function e(t){var n=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.authController.logout();case 2:return e.next=4,t.reset();case 4:return e.abrupt("return",null);case 5:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"hasPermissions",value:function(e,t){return 0!==t.length&&(null!=e&&0===t.filter(function(t){return!e.state.permissions.find(function(e){return e===t})}).length)}},{key:"refresh",value:function(){var e=Object(v.a)(d.a.mark(function e(t){var n=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.update(Object(v.a)(d.a.mark(function e(){var r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.authController.claims();case 3:return r=e.sent,e.abrupt("return",{loggedIn:!0,permissions:r.claims,username:r.token});case 7:return e.prev=7,e.t0=e.catch(0),e.next=11,t.reset();case 11:return e.abrupt("return",t.state);case 12:case"end":return e.stop()}},e,null,[[0,7]])})));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),e}(),U=(n(81),function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.props.loading?r.createElement("div",{className:"component--PageLoader"},r.createElement("div",null,"loading")):r.createElement(r.Fragment,null)}}]),t}(r.Component)),A=(n(83),function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.createElement("div",{className:"component--LayoutContentContainer"},this.props.children)}}]),t}(r.PureComponent)),F=(n(85),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).innerRef=void 0,n.innerRef=r.createRef(),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.props.error?(this.scrollAsync(),r.createElement("div",{className:"component--ErrorNotice",ref:this.innerRef},r.createElement("em",null,this.props.error.message),this.renderInnerErrors())):r.createElement(r.Fragment,null)}},{key:"renderInnerErrors",value:function(){if(null==this.props.error||!this.props.error.innerErrors)return"";for(var e=[],t=Object.entries(this.props.error.innerErrors),n=0;n<t.length;n++){var a=t[n];e.push(r.createElement("li",{key:a[0]},a[0],": ",a[1]))}return r.createElement("ul",null,e)}},{key:"scrollAsync",value:function(){var e=this;setTimeout(function(){null!=e.innerRef.current&&a.findDOMNode(e.innerRef.current).scrollIntoView({block:"end",behavior:"smooth"})},1)}}]),t}(r.Component)),Q=(n(87),function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.createElement("div",{className:"component--LayoutFormContainer"},r.createElement(F,{error:this.props.error}),this.props.children)}}]),t}(r.Component)),V=(n(89),function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.expand?"static":"absolute";return r.createElement("div",{className:"component--LayoutRightBox",style:{position:e}},this.props.children)}}]),t}(r.PureComponent)),L=(n(91),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).onSubmitLogin=function(e){e.preventDefault(),(new P).login(n.props.user,n.state.username,n.state.password)},n.onUsernameChange=function(e){n.setState({username:e.currentTarget.value})},n.onPasswordChange=function(e){n.setState({password:e.currentTarget.value})},n.state={password:"...",username:"username"},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.createElement("div",{className:"component--GenericLoginPage"},r.createElement(U,{loading:this.props.user.updating}),r.createElement(A,null,r.createElement("h3",{className:"notice"},"Login required")),r.createElement(Q,{error:this.props.user.error},r.createElement("form",{onSubmit:this.onSubmitLogin},r.createElement("fieldset",null,r.createElement("input",{type:"text",value:this.state.username,onChange:this.onUsernameChange})),r.createElement("fieldset",null,r.createElement("input",{type:"password",value:this.state.password,onChange:this.onPasswordChange})),r.createElement(V,{expand:!0},r.createElement("button",null,"Login")))))}}]),t}(r.Component)),z=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).unsubscribe=null,n.state={refreshed:!1,user:null},n}return Object(p.a)(t,e),Object(c.a)(t,null,[{key:"getDerivedStateFromProps",value:function(e,t){return e.user!==t.user?{user:e.user,refreshed:!1}:null}}]),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}},{key:"componentDidMount",value:function(){this.resubscribe()}},{key:"render",value:function(){var e=this.props.user.state.loggedIn?this.props.renderLoggedIn():this.props.renderLoggedOut();return r.createElement(r.Fragment,null,e)}},{key:"componentDidUpdate",value:function(){this.state.refreshed||this.resubscribe()}},{key:"resubscribe",value:function(){var e=this;this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null),this.state.user&&Object(v.a)(d.a.mark(function t(){var n;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.user){t.next=5;break}return e.unsubscribe=e.state.user.subscribe(function(){e.forceUpdate()}),n=new P,t.next=5,n.refresh(e.props.user);case 5:case"end":return t.stop()}},t)}))().then(function(){e.setState({refreshed:!0})})}}]),t}(r.Component),M=n(217),R=n(64),B=n(65),W=(n(152),function(e){function t(e){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).call(this,e))}return Object(p.a)(t,e),Object(c.a)(t,null,[{key:"safe",value:function(e){return B(e,{allowProtocolRelative:!0,allowedAttributes:{a:["href","name","target"],img:["src"]},allowedIframeHostnames:[],allowedTags:["h3","h4","h5","h6","blockquote","p","a","ul","ol","nl","li","b","i","strong","em","strike","code","hr","br","div","table","thead","caption","tbody","tr","th","td","pre","iframe","img"],allowedSchemes:["http","https"],allowedSchemesAppliedToAttributes:["href","src","cite"],allowedSchemesByTag:{},selfClosing:["img","br","hr","area","base","basefont","input","link","meta"]})}}]),Object(c.a)(t,[{key:"render",value:function(){var e=t.safe(this.props.value);return r.createElement("div",{className:"component--SafeHtml",dangerouslySetInnerHTML:{__html:e}})}}]),t}(r.Component)),H=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).converter=void 0,n.converter=new R.Converter,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){try{var e=this.converter.makeHtml(this.props.markdown);return r.createElement(r.Fragment,null,r.createElement(W,{value:e}))}catch(t){return r.createElement(F,{error:t})}}}]),t}(r.PureComponent),_=(n(154),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).events={},n.state={lastPropValue:"",value:""},n.events={onChange:function(e){return n.onChange(e)}},n}return Object(p.a)(t,e),Object(c.a)(t,null,[{key:"getDerivedStateFromProps",value:function(e,t){return e.value!==t.lastPropValue?{value:e.value,lastPropValue:e.value}:null}}]),Object(c.a)(t,[{key:"render",value:function(){return r.createElement("div",{className:"component--MarkdownEditor"},r.createElement("textarea",{value:this.state.value,onChange:this.events.onChange}),r.createElement("div",{className:"rendered"},r.createElement(H,{markdown:this.state.value})))}},{key:"onChange",value:function(e){var t=this,n=e.currentTarget.value;this.setState({value:n},function(){t.props.onChange(n)})}}]),t}(r.Component)),G=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).events={},n.unsubscribe=null,n.state={lastUpdate:new Date},n.events={onBodyChanged:function(e){return n.onBodyChanged(e)},onSave:function(e){return n.onSave(e)}},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.unsubscribe=this.props.answer.subscribe(function(){e.setState({lastUpdate:new Date})})}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}},{key:"render",value:function(){return r.createElement("div",{className:"component--Answer"},r.createElement("form",{action:"",onSubmit:this.events.onSave},r.createElement("fieldset",null,r.createElement(_,{value:this.props.answer.state.body,onChange:this.events.onBodyChanged})),r.createElement("fieldset",{className:"buttons"},r.createElement("button",{className:"submit"},this.props.saveText))))}},{key:"onSave",value:function(e){e.preventDefault(),this.props.submit()}},{key:"onBodyChanged",value:function(e){this.props.answer.update(Object(v.a)(d.a.mark(function t(){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{body:e});case 1:case"end":return t.stop()}},t)})))}}]),t}(r.Component),J=(n(156),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).innerRef=void 0,n.innerRef=r.createRef(),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.props.value?(this.scrollAsync(),r.createElement("div",{className:"component--InfoNotice",ref:this.innerRef},this.props.value)):r.createElement(r.Fragment,null)}},{key:"scrollAsync",value:function(){var e=this;setTimeout(function(){null!=e.innerRef.current&&a.findDOMNode(e.innerRef.current).scrollIntoView({block:"end",behavior:"smooth"})},1)}}]),t}(r.Component)),$=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"delete",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/topics/delete",{RowVersion:t.rowVersion,TopicId:t.topicId});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(v.a)(d.a.mark(function e(t,n){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=4;break}return e.next=3,this.post("/api/topics/get",{TopicId:n});case 3:return e.abrupt("return",e.sent);case 4:return e.next=6,this.post("/api/topics/get",{TopicName:t});case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/topics/update",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"search",value:function(){var e=Object(v.a)(d.a.mark(function e(t,n,r){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/topics/search",{limit:r,offset:n,query:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()}]),t}(T),X=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"fetch",value:function(e){var t=this;return this.update(Object(v.a)(d.a.mark(function n(){var r,a,s,u;return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e<=0?0:e*t.state.pageSize,n.next=3,t.state.fetchIds(t.state.query,r,t.state.pageSize);case 3:return a=n.sent,s=a.identityList.map(function(e){return t.state.fetchInstance(e)}),n.next=7,Promise.all(s);case 7:return u=n.sent,n.abrupt("return",{instances:u,moreResults:a.moreResults,page:e});case 9:case"end":return n.stop()}},n)})))}},{key:"next",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.state.moreResults){e.next=2;break}throw new Error("No more results in QuerySet");case 2:return e.abrupt("return",null);case 3:case"end":return e.stop()}},e)})));case 2:if(this.error){e.next=5;break}return e.next=5,this.fetch(this.state.page+1);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"prev",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.state.page<=0)){e.next=2;break}throw new Error("Already on first page of QuerySet");case 2:return e.abrupt("return",null);case 3:case"end":return e.stop()}},e)})));case 2:if(this.error){e.next=5;break}return e.next=5,this.fetch(this.state.page-1);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{fetchIds:function(){return Promise.reject(new Error("Not implemented"))},fetchInstance:function(){return Promise.reject(new Error("Not implemented"))},instances:[],moreResults:!1,page:0,pageSize:10,query:""}}},{key:"rebind",value:function(){var e=this;this.state.instances.map(function(t){t.parent=e})}}],[{key:"fromQuery",value:function(){var e=Object(v.a)(d.a.mark(function e(n,r){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new t(Object(s.a)({},n,{instances:[],moreResults:!1,page:-1})),null===r||void 0===r){e.next=4;break}return e.next=4,a.fetch(r);case 4:return e.abrupt("return",a);case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()}]),t}(w),Y=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"delete",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t,n=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new $,e.next=3,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.delete(n.state);case 2:return e.abrupt("return",n.blank());case 3:case"end":return e.stop()}},e)})));case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchData(t.state.name,t.state.topicId);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.blank());case 1:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t,n=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new $,e.next=3,this.update(Object(v.a)(d.a.mark(function e(){var r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Object(s.a)({},n.state),n.state.topicId){e.next=3;break}throw new Error("Topics can only be auto-generated, use Topic.get");case 3:return e.next=5,t.update(r);case 5:return e.next=7,n.fetchData(n.state.name,null);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e)})));case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{description:"",icon:"",name:"",rowVersion:"",topicId:""}}},{key:"fetchData",value:function(){var e=Object(v.a)(d.a.mark(function e(t,n){var r,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=new $,e.next=3,r.get(t,n);case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"rebind",value:function(){}}],[{key:"get",value:function(){var e=Object(v.a)(d.a.mark(function e(n){var r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new t).state.name=n,e.next=4,r.refresh();case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"search",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return X.fromQuery({fetchIds:t.searchForIds,fetchInstance:t.getById,pageSize:n,query:e},r)}},{key:"getById",value:function(){var e=Object(v.a)(d.a.mark(function e(n){var r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new t).state.topicId=n,e.next=4,r.refresh();case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"searchForIds",value:function(){var e=Object(v.a)(d.a.mark(function e(t,n,r){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new $,e.next=3,a.search(t,n,r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()}]),t}(w),K=n(213),Z=function(){function e(){Object(u.a)(this,e),this.root=void 0,this.root=I.get().baseUrl,this.root.endsWith("/")&&(this.root=this.root.replace(/\/*$/,""))}return Object(c.a)(e,[{key:"urlForAnswerEdit",value:function(e,t,n){return"".concat(this.root,"/t/").concat(e,"/").concat(t,"/answer/").concat(n,"/edit")}},{key:"urlForQuestion",value:function(e,t){return"".concat(this.root,"/t/").concat(e,"/").concat(t)}},{key:"urlForQuestionEdit",value:function(e,t){return"".concat(this.root,"/t/").concat(e,"/").concat(t,"/edit")}},{key:"urlForTopic",value:function(e){return"".concat(this.root,"/t/").concat(e)}},{key:"urlForTopicEdit",value:function(e){return"".concat(this.root,"/t/").concat(e,"/edit")}},{key:"urlForTopicAddQuestion",value:function(e){return"".concat(this.root,"/t/").concat(e,"/ask")}},{key:"urlForQuestionAnswer",value:function(e,t){return"".concat(this.root,"/t/").concat(e,"/").concat(t,"/answer")}},{key:"urlForHelp",value:function(){return"".concat(this.root,"/help")}},{key:"urlForRoot",value:function(){return"".concat(this.root)}},{key:"urlForLogout",value:function(){return"".concat(this.root,"/logout")}},{key:"urlForSelfProfile",value:function(){return"".concat(this.root,"/self")}},{key:"urlForTopicQuery",value:function(e,t){return"".concat(this.root,"/t/").concat(e,"/search/").concat(t)}},{key:"redirect",value:function(e){window.location.href=e}}]),e}();n(158);!function(e){e[e.AddQuestion=0]="AddQuestion",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.None=3]="None"}(N||(N={}));var ee,te=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).nav=void 0,n.nav=new Z,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){if(!this.props.topic)return r.createElement(r.Fragment,null);var e=this.getUrl();return r.createElement("div",{className:"component--TopicLink"},r.createElement(K.a,{to:e},this.props.children))}},{key:"getUrl",value:function(){switch(this.props.target){case N.AddQuestion:return this.nav.urlForTopicAddQuestion(this.props.topic);case N.View:return this.nav.urlForTopic(this.props.topic);case N.Edit:return this.nav.urlForTopicEdit(this.props.topic);case N.None:return this.nav.urlForRoot();default:throw new Error("Unsupported target")}}}]),t}(r.Component),ne=(n(162),function(e){if(e.topicId){var t=e.description||"no description";return r.createElement("div",{className:"desc"},r.createElement(te,{target:N.Edit,topic:e.name},t))}return r.createElement("div",{className:"desc"})}),re=function(e){return e.icon?r.createElement("div",{className:"icon"},r.createElement("img",{src:e.icon})):r.createElement(r.Fragment,null)},ae=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.name||"no topic",t=this.props.name?N.View:N.None;return r.createElement("div",{className:"component--TopicInfo"},r.createElement(re,this.props),r.createElement("div",null,r.createElement(te,{target:t,topic:e},r.createElement("h1",{className:"header"},e)),r.createElement(ne,this.props)))}}]),t}(r.Component),se=(n(164),function(e){function t(){var e,n;Object(u.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(n=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(a)))).nav=new Z,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.createElement("div",{className:"component--UserCurrentInfo"},r.createElement("div",null,r.createElement(K.a,{to:this.nav.urlForSelfProfile()},this.props.user.username)),r.createElement("div",{className:"logout"},r.createElement(K.a,{to:this.nav.urlForLogout()},"logout")))}}]),t}(r.Component)),ue=(n(166),function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=I.get(),t=new Z;return r.createElement("div",{className:"component--LayoutFooter"},r.createElement("div",null,r.createElement("div",{className:"message"},e.footerNotice),r.createElement("div",{className:"home"},r.createElement(K.a,{to:t.urlForRoot()},"Home")),r.createElement("div",{className:"help"},r.createElement(K.a,{to:t.urlForHelp()},"Help"))))}}]),t}(r.PureComponent)),ce=(n(168),function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.topic||(new Y).state;return r.createElement(r.Fragment,null,r.createElement("div",{className:"component--LayoutStandardHeader"},r.createElement(U,{loading:this.props.loading}),r.createElement(ae,e),r.createElement(se,{user:this.props.user})),r.createElement(ue,null))}}]),t}(r.Component));n(170);!function(e){e[e.Answer=0]="Answer",e[e.View=1]="View",e[e.Edit=2]="Edit"}(ee||(ee={}));var ie=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).nav=void 0,n.nav=new Z,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){if(!this.props.question)return r.createElement(r.Fragment,null);var e=this.getUrl();return r.createElement(K.a,{to:e},this.props.children)}},{key:"getUrl",value:function(){var e=this.props.question.state.topic,t=this.props.question.state.questionId;switch(this.props.target){case ee.View:return this.nav.urlForQuestion(e,t);case ee.Edit:return this.nav.urlForQuestionEdit(e,t);case ee.Answer:return this.nav.urlForQuestionAnswer(e,t);default:throw new Error("Unsupported target")}}}]),t}(r.Component),oe=(n(172),function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.createElement("div",{className:"component--LayoutRightBottom"},this.props.children)}}]),t}(r.PureComponent)),pe=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.props.show?r.createElement(r.Fragment,null,this.props.children):r.createElement(r.Fragment,null)}}]),t}(r.PureComponent),le=(n(174),function(e){function t(){var e,n;Object(u.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(n=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(a)))).onVoteUp=Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==n.props.userVotes){e.next=5;break}return e.next=3,n.props.onVote(0);case 3:e.next=7;break;case 5:return e.next=7,n.props.onVote(1);case 7:case"end":return e.stop()}},e)})),n.onVoteDown=Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(-1!==n.props.userVotes){e.next=5;break}return e.next=3,n.props.onVote(0);case 3:e.next=7;break;case 5:return e.next=7,n.props.onVote(-1);case 7:case"end":return e.stop()}},e)})),n.onStar=Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.props.showStars&&n.props.onStar){e.next=2;break}return e.abrupt("return");case 2:if(!(n.props.userStars>0)){e.next=7;break}return e.next=5,n.props.onStar(0);case 5:e.next=9;break;case 7:return e.next=9,n.props.onStar(1);case 9:case"end":return e.stop()}},e)})),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.userVotes>0?["up","active"]:["up"],t=this.props.userVotes<0?["down","active"]:["down"],n=this.props.userStars>0?["star","active"]:["star"];return r.createElement("div",{className:"component--VotesAndStars"},r.createElement("li",null,r.createElement("div",{className:e.join(" "),onClick:this.onVoteUp})),r.createElement("li",null,r.createElement("div",{className:"votes"},this.props.votes)),r.createElement("li",null,r.createElement("div",{className:t.join(" "),onClick:this.onVoteDown})),r.createElement(pe,{show:this.props.showStars},r.createElement("li",{className:"star-container"},r.createElement("div",{className:n.join(" "),onClick:this.onStar}))))}}]),t}(r.Component)),he=(n(176),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).nav=void 0,n.nav=new Z,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.tags.map(function(t){if(null==e.props.topic)return r.createElement("div",{key:t,className:"tag"},t);var n=e.nav.urlForTopicQuery(e.props.topic,"tag:".concat(t));return r.createElement("div",{key:t,className:"tag"},r.createElement(K.a,{to:n},t))});return 0===t.length?r.createElement(r.Fragment,null):r.createElement("div",{className:"component--TagList"},this.props.tags.length>0?t:"No tags")}}]),t}(r.Component)),fe=(n(178),function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.createElement("div",{className:"component--UserSummary"},"by: ",this.props.user.state.username)}}]),t}(r.PureComponent)),de=(n(180),function(e){function t(){var e,n;Object(u.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(n=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(a)))).onVote=function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>0)){e.next=5;break}return e.next=3,n.props.question.state.meta.voteUp();case 3:e.next=12;break;case 5:if(!(t<0)){e.next=10;break}return e.next=8,n.props.question.state.meta.voteDown();case 8:e.next=12;break;case 10:return e.next=12,n.props.question.state.meta.voteNeutral();case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.onStar=function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,n.props.question.state.meta.addStar();case 3:e.next=7;break;case 5:return e.next=7,n.props.question.state.meta.removeStar();case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.question.state.meta;return r.createElement("div",{className:"component--QuestionView"},r.createElement("div",{className:"metadata"},r.createElement(le,{showStars:!0,userStars:e.state.star?1:0,userVotes:e.state.votes,votes:e.state.global.votes,onVote:this.onVote,onStar:this.onStar})),r.createElement("div",{className:"output"},r.createElement("h2",null,this.props.question.state.title),r.createElement(he,{tags:this.props.question.state.tags,topic:this.props.question.state.topic}),r.createElement(H,{markdown:this.props.question.state.body}),r.createElement(oe,null,r.createElement(fe,{user:this.props.question.state.user}))))}}]),t}(r.Component)),ve=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"add",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/Answers/add",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/Answers/delete",{id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/Answers/get",{id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getMetadata",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/Answers/metadata",{id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateMetadata",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/Answers/updateMetadata",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/Answers/update",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"search",value:function(){var e=Object(v.a)(d.a.mark(function e(t,n,r){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/Answers/search",{limit:r,offset:n,questionId:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()}]),t}(T),me=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"voteUp",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ve,e.next=3,n.updateMetadata(Object(s.a)({},t.state,{votes:1}));case 3:return e.next=5,n.getMetadata(t.state.answerId);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"voteNeutral",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ve,e.next=3,n.updateMetadata(Object(s.a)({},t.state,{votes:0}));case 3:return e.next=5,n.getMetadata(t.state.answerId);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"voteDown",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ve,e.next=3,n.updateMetadata(Object(s.a)({},t.state,{votes:-1}));case 3:return e.next=5,n.getMetadata(t.state.answerId);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{answerId:"",answerMetaId:"",global:{votes:0},rowVersion:"",votes:0}}},{key:"rebind",value:function(){}}]),t}(w),be=new(function(){function e(){Object(u.a)(this,e),this.pending=null,this.requests={}}return Object(c.a)(e,[{key:"get",value:function(t){var n=this.requests[t];return n?e.isExpired(n)?(delete this.requests[t],null):n.value:null}},{key:"set",value:function(e,t,n){this.requests[e]={expires:Date.now()+n,value:t}}},{key:"waitPending",value:function(){var e=Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pending){e.next=3;break}return e.next=3,this.pending;case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=Object(v.a)(d.a.mark(function e(t){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,this.pending=new Promise(function(){var e=Object(v.a)(d.a.mark(function e(r,a){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:n=e.sent,r(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),a(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,n){return e.apply(this,arguments)}}()),e.next=4,this.pending;case 4:if(null!=n){e.next=6;break}throw new Error("No data returned from cache update query");case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}],[{key:"isExpired",value:function(e){return e.expires<Date.now()}}]),e}()),we=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"get",value:function(){var e=Object(v.a)(d.a.mark(function e(t){var n,r,a=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="/api/users/get::".concat(t),e.next=3,be.waitPending();case 3:if(!(r=be.get(n))){e.next=6;break}return e.abrupt("return",r);case 6:return e.next=8,be.update(Object(v.a)(d.a.mark(function e(){var r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.post("/api/users/get",{id:t});case 2:return r=e.sent,be.set(n,r,2e3),e.abrupt("return",r);case 5:case"end":return e.stop()}},e)})));case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),t}(T),je=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"reset",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.blank());case 1:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new we,e.next=3,n.get(t.state.userId);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{userId:"",username:""}}},{key:"rebind",value:function(){}}],[{key:"get",value:function(){var e=Object(v.a)(d.a.mark(function e(n){var r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new t).state.userId=n,e.next=4,r.refresh();case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),t}(w),Oe=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"refresh",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchAnswerData(t.state.answerId);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.blank());case 1:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t,n=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new ve,e.next=3,this.update(Object(v.a)(d.a.mark(function e(){var r,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(delete(r=Object(s.a)({},n.state)).meta,delete r.user,n.state.answerId){e.next=10;break}return e.next=6,t.add(r);case 6:return a=e.sent,e.next=9,n.fetchAnswerData(a.answerId);case 9:return e.abrupt("return",e.sent);case 10:return e.next=12,t.update(r);case 12:return e.next=14,n.fetchAnswerData(n.state.answerId);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}},e)})));case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ve,e.next=3,n.delete(t.state.answerId);case 3:return e.abrupt("return",t.blank());case 4:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{answerId:"",body:"...",canEdit:!1,meta:new me,questionId:"",rowVersion:"",user:new je,userId:""}}},{key:"fetchAnswerData",value:function(){var e=Object(v.a)(d.a.mark(function e(t){var n,r,a,u;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ve,e.next=3,n.get(t);case 3:return r=e.sent,e.t0=me,e.next=7,n.getMetadata(t);case 7:return e.t1=e.sent,a=new e.t0(e.t1),e.next=11,je.get(r.userId);case 11:return u=e.sent,e.abrupt("return",Object(s.a)({},r,{meta:a,user:u}));case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"rebind",value:function(){this.state.meta.parent=this}}],[{key:"get",value:function(){var e=Object(v.a)(d.a.mark(function e(n){var r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new t).state.answerId=n,e.next=4,r.refresh();case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"search",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return X.fromQuery({fetchIds:t.searchForIds,fetchInstance:t.get,pageSize:n,query:e},r)}},{key:"searchForIds",value:function(){var e=Object(v.a)(d.a.mark(function e(t,n,r){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new ve,e.next=3,a.search(t,n,r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()}]),t}(w),ke=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"add",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/questions/add",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/questions/delete",{id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/questions/get",{id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getMetadata",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/questions/metadata",{id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSummary",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/questions/getSummary",{id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateMetadata",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/questions/updateMetadata",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/questions/update",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"search",value:function(){var e=Object(v.a)(d.a.mark(function e(t,n,r){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("/api/questions/search",{limit:r,offset:n,query:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()}]),t}(T),ye=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"voteUp",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ke,e.next=3,n.updateMetadata(Object(s.a)({},t.state,{votes:1}));case 3:return e.next=5,n.getMetadata(t.state.questionId);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"voteNeutral",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ke,e.next=3,n.updateMetadata(Object(s.a)({},t.state,{votes:0}));case 3:return e.next=5,n.getMetadata(t.state.questionId);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"voteDown",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ke,e.next=3,n.updateMetadata(Object(s.a)({},t.state,{votes:-1}));case 3:return e.next=5,n.getMetadata(t.state.questionId);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"addStar",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ke,e.next=3,n.updateMetadata(Object(s.a)({},t.state,{star:!0}));case 3:return e.next=5,n.getMetadata(t.state.questionId);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"removeStar",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ke,e.next=3,n.updateMetadata(Object(s.a)({},t.state,{star:!1}));case 3:return e.next=5,n.getMetadata(t.state.questionId);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{global:{votes:0},questionId:"",questionMetaId:"",rowVersion:"",star:!1,votes:0}}},{key:"rebind",value:function(){}}]),t}(w),xe=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"delete",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t,n=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new ke,e.next=3,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.delete(n.state.questionId);case 2:return e.abrupt("return",{questionId:"",rowVersion:""});case 3:case"end":return e.stop()}},e)})));case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchQuestionData(t.state.questionId);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.blank());case 1:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t,n=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new ke,e.next=3,this.update(Object(v.a)(d.a.mark(function e(){var r,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(delete(r=Object(s.a)({},n.state)).meta,delete r.user,n.state.questionId){e.next=10;break}return e.next=6,t.add(r);case 6:return a=e.sent,e.next=9,n.fetchQuestionData(a.questionId);case 9:return e.abrupt("return",e.sent);case 10:return e.next=12,t.update(r);case 12:return e.next=14,n.fetchQuestionData(n.state.questionId);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}},e)})));case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{body:"...",canEdit:!1,meta:new ye,questionId:"",rowVersion:"",tags:[],title:"new question",topic:"default",user:new je,userId:""}}},{key:"fetchQuestionData",value:function(){var e=Object(v.a)(d.a.mark(function e(t){var n,r,a,u;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ke,e.next=3,n.get(t);case 3:return r=e.sent,e.t0=ye,e.next=7,n.getMetadata(t);case 7:return e.t1=e.sent,a=new e.t0(e.t1),e.next=11,je.get(r.userId);case 11:return u=e.sent,e.abrupt("return",Object(s.a)({},r,{meta:a,user:u}));case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"rebind",value:function(){this.state.meta.parent=this}}],[{key:"get",value:function(){var e=Object(v.a)(d.a.mark(function e(n){var r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new t).state.questionId=n,e.next=4,r.refresh();case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"search",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return X.fromQuery({fetchIds:t.searchForIds,fetchInstance:t.get,pageSize:n,query:e},r)}},{key:"searchForIds",value:function(){var e=Object(v.a)(d.a.mark(function e(t,n,r){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new ke,e.next=3,a.search(t,n,r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()}]),t}(w),ge=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this))).isLoaded=!1,n.unsubscribe=void 0,n.unsubscribe=n.subscribe(function(){e()}),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"load",value:function(e){var t=this;this.isLoaded=!0,this.runAsync(Object(v.a)(d.a.mark(function n(){return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.loadInitialData(e);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n)})))}},{key:"unload",value:function(){this.isLoaded&&(this.isLoaded=!1,this.unsubscribe())}},{key:"runAsync",value:function(e){setTimeout(function(){e().then(function(){},function(e){y.get().error(e)})},1)}}]),t}(w),Ee=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"answerQuestion",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({notice:null}));case 1:case"end":return e.stop()}},e)})));case 2:return e.next=4,this.state.answer.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{questionId:t.state.question.state.questionId});case 1:case"end":return e.stop()}},e)})));case 4:return e.next=6,this.state.answer.save();case 6:if(null!==this.state.answer.error){e.next=9;break}return e.next=9,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({notice:"Saved answer"}));case 1:case"end":return e.stop()}},e)})));case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadInitialData",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.get(t.topic);case 2:if(!(n=e.sent).error){e.next=5;break}throw n.error;case 5:return e.next=7,xe.get(t.question);case 7:if(!(r=e.sent).error){e.next=10;break}throw r.error;case 10:return e.abrupt("return",{question:r,topic:n,answer:new Oe});case 11:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{answer:new Oe,notice:null,question:new xe,topic:new Y}}},{key:"rebind",value:function(){this.state.topic.parent=this,this.state.question.parent=this,this.state.answer.parent=this}}]),t}(ge),qe=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).data=void 0,n.answerQuestionEvent=function(){return n.data.answerQuestion()},n.data=new Ee(function(){return n.forceUpdate()}),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.data.unload(),this.data=new Ee(function(){return e.forceUpdate()}),this.data.load(this.props)}},{key:"componentWillUnmount",value:function(){this.data.unload()}},{key:"render",value:function(){if(!this.guardInvalidState())return"";var e=this.data.state.question,t=this.data.state.answer,n=this.data.state.topic;return r.createElement("div",{className:"component--TopicHomePage"},r.createElement(ce,{user:this.props.user.state,topic:n.state,loading:this.data.updating}),r.createElement(A,null,r.createElement(V,{expand:!1},r.createElement(ie,{question:e,target:ee.View},"View full question")),r.createElement(de,{question:e})),r.createElement(Q,{error:this.data.state.question.error},r.createElement(J,{value:this.data.state.notice}),r.createElement(G,{submit:this.answerQuestionEvent,answer:t,saveText:"Save"})))}},{key:"guardInvalidState",value:function(){return null!==this.data}}]),t}(r.Component),Ce=(n(182),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).toggleOpenState=function(){n.setState({open:!n.state.open})},n.state={open:!1},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.state.open?r.createElement("div",{className:"component--LayoutUnsafeBox"},r.createElement("div",{className:"header",onClick:this.toggleOpenState},this.props.title),this.props.children):r.createElement("div",{className:"component--LayoutUnsafeBox"},r.createElement("div",{className:"header",onClick:this.toggleOpenState},this.props.title))}}]),t}(r.Component)),Se=function(e){function t(){var e,n;Object(u.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(n=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(a)))).auth=new P,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.createElement(r.Fragment,null,this.authorized()?this.props.children:r.createElement(r.Fragment,null))}},{key:"authorized",value:function(){return this.auth.hasPermissions(this.props.user,this.props.requirePermissions)}}]),t}(r.Component),Ie=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.createElement(Se,{user:this.props.user,requirePermissions:this.props.permissions},r.createElement(A,null,r.createElement(Ce,{title:"Unsafe commands"},r.createElement("form",null,r.createElement("fieldset",null,this.props.children)))))}}]),t}(r.Component),Ne=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"saveAnswer",value:function(){var e=Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({notice:null}));case 1:case"end":return e.stop()}},e)})));case 2:return e.next=4,this.state.answer.save();case 4:if(null!==this.state.answer.error){e.next=7;break}return e.next=7,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({notice:"Saved answer"}));case 1:case"end":return e.stop()}},e)})));case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"deleteAnswer",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state.answer.delete();case 2:t=new Z,n=this.state.question,t.redirect(t.urlForQuestion(n.state.topic,n.state.questionId));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadInitialData",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n,r,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.get(t.topic);case 2:if(!(n=e.sent).error){e.next=5;break}throw n.error;case 5:return e.next=7,xe.get(t.question);case 7:if(!(r=e.sent).error){e.next=10;break}throw r.error;case 10:return e.next=12,Oe.get(t.answer);case 12:if(!(a=e.sent).error){e.next=15;break}throw a.error;case 15:if(a.state.questionId===r.state.questionId){e.next=17;break}throw new Error("Invalid answer id for topic");case 17:return e.abrupt("return",{question:r,topic:n,answer:a});case 18:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{answer:new Oe,notice:null,question:new xe,topic:new Y}}},{key:"rebind",value:function(){this.state.topic.parent=this,this.state.question.parent=this,this.state.answer.parent=this}}]),t}(ge),Te=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).data=void 0,n.saveAnswerEvent=function(){return n.data.saveAnswer()},n.onDeleteQuestion=function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,n.data.deleteAnswer();case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.data=new Ne(function(){return n.forceUpdate()}),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.data.unload(),this.data=new Ne(function(){return e.forceUpdate()}),this.data.load(this.props)}},{key:"componentWillUnmount",value:function(){this.data.unload()}},{key:"render",value:function(){if(!this.guardInvalidState())return"";var e=this.data.state.question,t=this.data.state.answer,n=this.data.state.topic;return r.createElement("div",{className:"component--TopicHomePage"},r.createElement(ce,{user:this.props.user.state,topic:n.state,loading:this.data.updating}),r.createElement(A,null,r.createElement(de,{question:e})),r.createElement(Q,{error:this.data.state.answer.error},r.createElement(V,{expand:!0},r.createElement(ie,{question:e,target:ee.View},"Close")),r.createElement(J,{value:this.data.state.notice}),r.createElement(G,{submit:this.saveAnswerEvent,answer:t,saveText:"Save"})),r.createElement(Ie,{user:this.props.user,permissions:["CanDelete:Answer"]},r.createElement(V,{expand:!0},r.createElement("p",null,"Delete this answer?"),r.createElement("p",null,"Careful! No undo for this!"),r.createElement("button",{onClick:this.onDeleteQuestion},"Delete answer"))))}},{key:"guardInvalidState",value:function(){return null!==this.data}}]),t}(r.Component),De=(n(184),function(e){return r.createElement("div",{className:"tip"},e.children)}),Pe=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=new Z;return r.createElement("div",{className:"component--TopicHomePage"},r.createElement(A,null,r.createElement("h1",null,"Help"),r.createElement(De,null,"To start a new topic, just go to ",e.urlForTopic("NAME")),r.createElement(De,null,"Searching for tags:",r.createElement("code",null,"tag:name tag:name2 some search")),r.createElement(De,null,"Searching for anything in a topic:",r.createElement("code",null,"topic:name *")),r.createElement(De,null,"Searching in multiple topics:",r.createElement("code",null,"topic:name topic:other query")),r.createElement(De,null,"Searching in any topic:",r.createElement("code",null,"topic:* query"))),r.createElement(ue,null))}}]),t}(r.Component),Ue=n(219),Ae=(n(186),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).onLogout=Object(v.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=n.props.user,n.setState({redirect:!0},Object(v.a)(d.a.mark(function e(){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new P,e.next=3,n.logout(t);case 3:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e)})),n.state={redirect:!1},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.state.redirect?r.createElement(Ue.a,{to:(new Z).urlForRoot()}):r.createElement("div",{className:"component--GenericLogoutPage"},r.createElement(ce,{user:this.props.user.state,topic:null,loading:this.props.user.updating}),r.createElement(A,null,r.createElement("h3",{className:"notice"},"Logout?"),r.createElement("p",null,"Are you sure? Your current session will be abandoned.")),r.createElement(A,null,r.createElement(V,{expand:!0},r.createElement("button",{onClick:this.onLogout},"Logout"))))}}]),t}(r.Component)),Fe=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).events={},n.state={lastPropValue:"",value:""},n.events={onChange:function(e){return n.onChange(e)}},n}return Object(p.a)(t,e),Object(c.a)(t,null,[{key:"getDerivedStateFromProps",value:function(e,t){return e.value!==t.lastPropValue?{value:e.value,lastPropValue:e.value}:null}}]),Object(c.a)(t,[{key:"render",value:function(){return r.createElement("input",{value:this.state.value,onChange:this.events.onChange})}},{key:"onChange",value:function(e){var t=this,n=e.currentTarget.value;this.setState({value:n},function(){t.props.onChange(n)})}}]),t}(r.Component);n(189);var Qe,Ve=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).onTagsChangedEvent=void 0,n.state={lastTags:[],tagEditValue:""},n.onTagsChangedEvent=function(e){return n.onTagsChanged(e)},n}return Object(p.a)(t,e),Object(c.a)(t,null,[{key:"getDerivedStateFromProps",value:function(e,t){return function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}(e.value,t.lastTags)?null:{tagEditValue:e.value.join(", "),lastTags:e.value}}},{key:"onlyUnique",value:function(e,t,n){return n.indexOf(e)===t}}]),Object(c.a)(t,[{key:"render",value:function(){return r.createElement("div",{className:"component--TagPicker"},r.createElement(Fe,{value:this.state.tagEditValue,onChange:this.onTagsChangedEvent}),r.createElement("div",{className:"rendered"},r.createElement(he,{tags:this.props.value,topic:null})))}},{key:"onTagsChanged",value:function(e){var n=this;this.setState({tagEditValue:e},function(){var r=e.split(",").map(function(e){return e.trim()}).filter(function(e){return e.length>0}).filter(t.onlyUnique);n.props.onChange(r)})}}]),t}(r.Component),Le=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).onSaveEvent=void 0,n.onTitleChangedEvent=void 0,n.onTagsChangedEvent=void 0,n.onBodyChangedEvent=void 0,n.onTopicChanged=function(e){n.props.question.update(Object(v.a)(d.a.mark(function t(){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{topic:e});case 1:case"end":return t.stop()}},t)})))},n.onBodyChangedEvent=function(e){return n.onBodyChanged(e)},n.onSaveEvent=function(e){return n.onSave(e)},n.onTagsChangedEvent=function(e){return n.onTagsChanged(e)},n.onTitleChangedEvent=function(e){return n.onTitleChanged(e)},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.createElement("div",{className:"component--Question"},r.createElement("form",{action:"",onSubmit:this.onSaveEvent},r.createElement(pe,{show:this.props.showTopic},r.createElement("fieldset",null,r.createElement(Fe,{value:this.props.question.state.topic,onChange:this.onTopicChanged}))),r.createElement("fieldset",null,r.createElement(Fe,{value:this.props.question.state.title,onChange:this.onTitleChangedEvent})),r.createElement("fieldset",null,r.createElement(_,{value:this.props.question.state.body,onChange:this.onBodyChangedEvent})),r.createElement("fieldset",null,r.createElement(Ve,{value:this.props.question.state.tags,onChange:this.onTagsChangedEvent})),r.createElement("fieldset",{className:"buttons"},r.createElement("button",{className:"submit"},this.props.saveText))))}},{key:"onSave",value:function(e){e.preventDefault(),this.props.submit()}},{key:"onTitleChanged",value:function(e){this.props.question.update(Object(v.a)(d.a.mark(function t(){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{title:e});case 1:case"end":return t.stop()}},t)})))}},{key:"onTagsChanged",value:function(e){this.props.question.update(Object(v.a)(d.a.mark(function t(){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{tags:e});case 1:case"end":return t.stop()}},t)})))}},{key:"onBodyChanged",value:function(e){this.props.question.update(Object(v.a)(d.a.mark(function t(){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{body:e});case 1:case"end":return t.stop()}},t)})))}}]),t}(r.Component),ze=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"askQuestion",value:function(){var e=Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({notice:null}));case 1:case"end":return e.stop()}},e)})));case 2:return e.next=4,this.state.question.save();case 4:if(null!==this.state.question.error){e.next=7;break}return e.next=7,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({notice:"Saved question"}));case 1:case"end":return e.stop()}},e)})));case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadInitialData",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.get(t.topic);case 2:if(!(n=e.sent).error){e.next=5;break}throw n.error;case 5:return r=new xe,e.next=8,r.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{topic:n.state.name});case 1:case"end":return e.stop()}},e)})));case 8:return e.abrupt("return",{question:r,topic:n});case 9:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{notice:null,question:new xe,topic:new Y}}},{key:"rebind",value:function(){this.state.topic.parent=this,this.state.question.parent=this}}]),t}(ge),Me=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).data=void 0,n.askQuestion=function(){return n.data.askQuestion()},n.data=new ze(function(){return n.forceUpdate()}),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.data.unload(),this.data=new ze(function(){return e.forceUpdate()}),this.data.load(this.props)}},{key:"componentWillUnmount",value:function(){this.data.unload()}},{key:"render",value:function(){if(!this.guardInvalidState())return"";var e=this.data.state.question,t=this.data.state.topic;return r.createElement("div",{className:"component--TopicHomePage"},r.createElement(ce,{user:this.props.user.state,topic:t.state,loading:this.data.updating}),r.createElement(Q,{error:this.data.state.question.error},r.createElement(pe,{show:e.state.questionId},r.createElement(V,{expand:!0},r.createElement(ie,{question:e,target:ee.View},"View"))),r.createElement(J,{value:this.data.state.notice}),r.createElement(Le,{showTopic:!1,submit:this.askQuestion,question:e,saveText:"Save"})))}},{key:"guardInvalidState",value:function(){return null!==this.data}}]),t}(r.Component),Re=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"updateQuestion",value:function(){var e=Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({notice:null}));case 1:case"end":return e.stop()}},e)})));case 2:return e.next=4,this.state.question.save();case 4:if(null!==this.state.question.error){e.next=7;break}return e.next=7,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({notice:"Saved question"}));case 1:case"end":return e.stop()}},e)})));case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"deleteQuestion",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state.question.delete();case 2:t=new Z,n=t.urlForTopic(this.state.topic.state.name),t.redirect(n);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadInitialData",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.get(t.topic);case 2:if(!(n=e.sent).error){e.next=5;break}throw n.error;case 5:return e.next=7,xe.get(t.question);case 7:if(!(r=e.sent).error){e.next=10;break}throw r.error;case 10:return e.abrupt("return",{question:r,topic:n});case 11:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{notice:null,question:new xe,topic:new Y}}},{key:"rebind",value:function(){this.state.topic.parent=this,this.state.question.parent=this}}]),t}(ge),Be=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).data=void 0,n.onUpdateQuestionEvent=function(){return n.data.updateQuestion()},n.onDeleteQuestion=function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,n.data.deleteQuestion();case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.data=new Re(function(){return n.forceUpdate()}),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.data.unload(),this.data=new Re(function(){return e.forceUpdate()}),this.data.load(this.props)}},{key:"componentWillUnmount",value:function(){this.data.unload()}},{key:"render",value:function(){if(!this.guardInvalidState())return"";var e=this.data.state.question,t=this.data.state.topic;return r.createElement("div",{className:"component--TopicHomePage"},r.createElement(ce,{user:this.props.user.state,topic:t.state,loading:this.data.updating}),r.createElement(Q,{error:this.data.state.question.error},r.createElement(V,{expand:!0},r.createElement(ie,{question:e,target:ee.View},"Close")),r.createElement(J,{value:this.data.state.notice}),r.createElement(Le,{showTopic:!0,submit:this.onUpdateQuestionEvent,question:e,saveText:"Save"})),r.createElement(Ie,{user:this.props.user,permissions:["CanDelete:Question"]},r.createElement(V,{expand:!0},r.createElement("p",null,"Delete this question?"),r.createElement("p",null,"Careful! No undo for this!"),r.createElement("button",{onClick:this.onDeleteQuestion},"Delete question"))))}},{key:"guardInvalidState",value:function(){return null!==this.data}}]),t}(r.Component);n(191);!function(e){e[e.Edit=0]="Edit"}(Qe||(Qe={}));var We=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).nav=void 0,n.nav=new Z,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){if(!this.props.question.state.questionId)return r.createElement(r.Fragment,null);var e=this.getUrl();return r.createElement("div",{className:"component--AnswerLink"},r.createElement("a",{href:e},this.props.children))}},{key:"getUrl",value:function(){switch(this.props.target){case Qe.Edit:return this.nav.urlForAnswerEdit(this.props.question.state.topic,this.props.question.state.questionId,this.props.answer.state.answerId);default:throw new Error("Unsupported target")}}}]),t}(r.Component),He=(n(193),function(e){function t(){var e,n;Object(u.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(n=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(a)))).onVote=function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>0)){e.next=5;break}return e.next=3,n.props.answer.state.meta.voteUp();case 3:e.next=12;break;case 5:if(!(t<0)){e.next=10;break}return e.next=8,n.props.answer.state.meta.voteDown();case 8:e.next=12;break;case 10:return e.next=12,n.props.answer.state.meta.voteNeutral();case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.answer.state.meta;return r.createElement("div",{className:"component--AnswerView"},r.createElement(pe,{show:this.props.answer.state.canEdit},r.createElement(V,{expand:!1},r.createElement(We,{question:this.props.question,answer:this.props.answer,target:Qe.Edit},"Edit"))),r.createElement("div",{className:"metadata"},r.createElement(le,{showStars:!1,userStars:0,userVotes:e.state.votes,votes:e.state.global.votes,onVote:this.onVote,onStar:null})),r.createElement("div",{className:"output"},r.createElement("div",{className:"rendered"},r.createElement(H,{markdown:this.props.answer.state.body})),r.createElement(oe,null,r.createElement(fe,{user:this.props.answer.state.user}))))}}]),t}(r.Component)),_e=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.createElement("div",{className:"component--AnswerList"},this.renderAnswerList())}},{key:"renderAnswerList",value:function(){var e=this;return null==this.props.answers.state.instances?[]:this.props.answers.state.instances.map(function(t){return r.createElement(A,{key:t.state.answerId},r.createElement(He,{answer:t,question:e.props.question,topic:e.props.topic}))})}}]),t}(r.Component),Ge=(n(195),function(e){function t(){var e,n;Object(u.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(n=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(a)))).onChangeSize=function(e){var t=Number(e.currentTarget.value);n.props.onChangeSize(t)},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.allowedSizes.map(function(e){return r.createElement("option",{key:e},e)});return r.createElement("div",{className:"component--QuerySetPaginator"},r.createElement(F,{error:this.props.error}),r.createElement(A,null,r.createElement("div",{className:"parts"},r.createElement("div",{className:"part"},"Results per page:",r.createElement("select",{value:this.props.queryState.pageSize,onChange:this.onChangeSize},e)),r.createElement("div",{className:"part buttons"},r.createElement("div",null,r.createElement(pe,{show:this.props.queryState.page>0},r.createElement("button",{onClick:this.props.onPrev},"Prev")),r.createElement(pe,{show:this.props.queryState.moreResults},r.createElement("button",{onClick:this.props.onNext},"Next")))))))}}]),t}(r.PureComponent)),Je=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"next",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.state.answers.next();case 2:return e.abrupt("return",null);case 3:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"prev",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.state.answers.prev();case 2:return e.abrupt("return",null);case 3:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setPageSize",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{pageSize:t});case 1:case"end":return e.stop()}},e)})));case 2:return e.next=4,this.refreshData();case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"loadInitialData",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.get(t.topic);case 2:if(!(n=e.sent).error){e.next=5;break}throw n.error;case 5:return e.next=7,xe.get(t.question);case 7:if(!(r=e.sent).error){e.next=10;break}throw r.error;case 10:return e.abrupt("return",{question:r,topic:n});case 11:case"end":return e.stop()}},e)})));case 2:return e.next=4,this.refreshData();case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{answers:new X,notice:null,pageSize:5,question:new xe,topic:new Y}}},{key:"rebind",value:function(){this.state.topic.parent=this,this.state.question.parent=this,this.state.answers.parent=this}},{key:"refreshData",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state.question,e.next=3,Oe.search(n.state.questionId,t.state.pageSize);case 3:return r=e.sent,e.abrupt("return",{answers:r});case 5:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}(ge),$e=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).data=void 0,n.onChangeSize=function(e){return n.data.setPageSize(e)},n.onNext=function(){return n.data.next()},n.onPrev=function(){return n.data.prev()},n.data=new Je(function(){return n.forceUpdate()}),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.data.unload(),this.data=new Je(function(){return e.forceUpdate()}),this.data.load(this.props)}},{key:"componentWillUnmount",value:function(){this.data.unload()}},{key:"render",value:function(){if(!this.guardInvalidState())return"";var e=this.data.state.question,t=this.data.state.answers,n=this.data.state.topic;return r.createElement("div",{className:"component--TopicViewQuestionPage"},r.createElement(ce,{user:this.props.user.state,topic:n.state,loading:this.data.updating}),r.createElement(A,null,r.createElement(V,{expand:!1},r.createElement(pe,{show:e.state.canEdit},r.createElement(ie,{question:e,target:ee.Edit},"Edit")),r.createElement(te,{topic:e.state.topic,target:N.View},"Close")),r.createElement(de,{question:e})),r.createElement(_e,{topic:this.data.state.topic,question:this.data.state.question,answers:this.data.state.answers}),r.createElement(Ge,{allowedSizes:[1,5,10,25],queryState:t.state,onChangeSize:this.onChangeSize,onNext:this.onNext,onPrev:this.onPrev,error:t.error}),r.createElement(A,null,r.createElement(V,{expand:!0},r.createElement(ie,{question:e,target:ee.Answer},r.createElement("button",null,"Answer Question")))))}},{key:"guardInvalidState",value:function(){return null!==this.data}}]),t}(r.Component),Xe=n(215),Ye=(n(197),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).searchStream=new b.a,n.onChangeEvent=function(e){return n.searchStream.next(e)},n.searchStream.pipe(Object(Xe.a)(n.props.debounce)).subscribe(function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.props.onChange(t);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.createElement("div",{className:"component--SearchBar"},r.createElement(Q,{error:this.props.error},r.createElement("form",null,r.createElement("fieldset",null,r.createElement(Fe,{value:this.props.value,onChange:this.onChangeEvent})))))}}]),t}(r.Component));Ye.defaultProps={debounce:200};n(199);var Ke=function(e){return e.topic.state.icon?r.createElement("div",{className:"icon"},r.createElement("img",{src:e.topic.state.icon})):r.createElement(r.Fragment,null)},Ze=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.topic.state.description||"no description";return r.createElement("div",{className:"component--TopicView"},r.createElement(Ke,{topic:this.props.topic}),r.createElement("div",null,r.createElement("div",null,r.createElement(te,{topic:this.props.topic.state.name,target:N.View},r.createElement("h2",null,this.props.topic.state.name))),r.createElement("div",null,e)))}}]),t}(r.Component),et=(n(201),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).state={page:0,pageSize:10},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.createElement("div",{className:"component--TopicList"},this.renderList())}},{key:"renderList",value:function(){return null==this.props.topics.state.instances?[]:this.props.topics.state.instances.map(function(e){return e.state.topicId?r.createElement("div",{className:"item",key:e.state.topicId},r.createElement(A,null,r.createElement(Ze,{topic:e}))):r.createElement(r.Fragment,null)})}}]),t}(r.Component)),tt=function(e){function t(e){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).call(this,e))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"search",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{search:t});case 1:case"end":return e.stop()}},e)})));case 2:return e.next=4,this.update(Object(v.a)(d.a.mark(function e(){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.search(t);case 2:if(!(n=e.sent).error){e.next=5;break}throw n.error;case 5:return e.abrupt("return",{topics:n});case 6:case"end":return e.stop()}},e)})));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"loadInitialData",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.search(t.search);case 2:if(!(n=e.sent).error){e.next=5;break}throw n.error;case 5:return e.abrupt("return",{topics:n,search:t.search});case 6:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{search:"",topics:new X}}},{key:"rebind",value:function(){this.state.topics.parent=this}}]),t}(ge),nt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).data=void 0,n.onSearchEvent=function(e){return n.onSearch(e)},n.data=new tt(function(){return n.forceUpdate()}),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.data.unload(),this.data=new tt(function(){return e.forceUpdate()}),this.data.load(this.props)}},{key:"componentWillUnmount",value:function(){this.data.unload()}},{key:"render",value:function(){if(!this.guardInvalidState())return r.createElement(r.Fragment,null);var e=this.data.state.search,t=this.data.state.topics;return r.createElement("div",{className:"component--TopicDiscoverPage"},r.createElement(ce,{user:this.props.user.state,topic:null,loading:this.data.updating}),r.createElement(Ye,{value:e,onChange:this.onSearchEvent,error:this.data.error}),r.createElement(et,{topics:t}))}},{key:"guardInvalidState",value:function(){return null!==this.data}},{key:"onSearch",value:function(e){this.data.search(e)}}]),t}(r.Component),rt=(n(203),function(e){return e.value?r.createElement("img",{src:e.value}):r.createElement(r.Fragment,null)}),at=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).onChangeEvent=function(e){return n.onChange(e)},n.state={lastPropValue:"",loaded:0,loading:!1,total:0,value:""},n}return Object(p.a)(t,e),Object(c.a)(t,null,[{key:"getDerivedStateFromProps",value:function(e,t){return e.value!==t.lastPropValue?{value:e.value,lastPropValue:e.value}:null}}]),Object(c.a)(t,[{key:"render",value:function(){return r.createElement("div",{className:"component--InlineImgEditor"},r.createElement("div",{className:"preview"},r.createElement(rt,this.props)),this.state.loading?r.createElement("div",{className:"progress"},this.state.loaded," / ",this.state.total):r.createElement(r.Fragment,null),r.createElement("input",{type:"file",onChange:this.onChangeEvent}))}},{key:"onChange",value:function(e){var t=this;if(e.currentTarget.files&&e.currentTarget.files.length>0){var n=e.currentTarget.files[0],r=new FileReader;this.setState({loading:!0},function(){r.onloadend=function(e){var n=r.result;t.setState({loaded:e.loaded,loading:!1,total:e.total,value:n},function(){t.props.onChange(n)})},r.onprogress=function(e){t.setState({loaded:e.loaded,total:e.total})},r.readAsDataURL(n)})}}}]),t}(r.Component),st=function(e){function t(){var e,n;Object(u.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(n=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(a)))).onDescChangedEvent=function(e){return n.onDescChanged(e)},n.onIconChangedEvent=function(e){return n.onIconChanged(e)},n.onSaveEvent=function(e){return n.onSave(e)},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.createElement("div",{className:"component--Question"},r.createElement("form",{action:"",onSubmit:this.onSaveEvent},r.createElement("fieldset",null,r.createElement(Fe,{value:this.props.topic.state.description,onChange:this.onDescChangedEvent})),r.createElement("fieldset",null,r.createElement(at,{value:this.props.topic.state.icon,onChange:this.onIconChangedEvent})),r.createElement("fieldset",{className:"buttons"},r.createElement("button",{className:"submit"},this.props.saveText))))}},{key:"onSave",value:function(e){e.preventDefault(),this.props.submit()}},{key:"onDescChanged",value:function(e){this.props.topic.update(Object(v.a)(d.a.mark(function t(){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{description:e});case 1:case"end":return t.stop()}},t)})))}},{key:"onIconChanged",value:function(e){this.props.topic.update(Object(v.a)(d.a.mark(function t(){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{icon:e});case 1:case"end":return t.stop()}},t)})))}}]),t}(r.Component),ut=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"saveTopic",value:function(){var e=Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({notice:null}));case 1:case"end":return e.stop()}},e)})));case 2:return e.next=4,this.state.topic.save();case 4:if(null!==this.state.topic.error){e.next=7;break}return e.next=7,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({notice:"Saved topic"}));case 1:case"end":return e.stop()}},e)})));case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"deleteTopic",value:function(){var e=Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state.topic.delete();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadInitialData",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.get(t.topic);case 2:if(!(n=e.sent).error){e.next=5;break}throw n.error;case 5:return e.abrupt("return",{topic:n});case 6:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{notice:null,topic:new Y}}},{key:"rebind",value:function(){this.state.topic.parent=this}}]),t}(ge),ct=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).data=void 0,n.redirect=void 0,n.onSubmitFormEvent=Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.data.saveTopic();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),n.onDeleteTopic=function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,n.data.deleteTopic();case 3:n.data.state.topic.error||(n.redirect=!0);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.redirect=!1,n.data=new ut(function(){return n.forceUpdate()}),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.data.unload(),this.data=new ut(function(){return e.forceUpdate()}),this.data.load(this.props)}},{key:"componentWillUnmount",value:function(){this.data.unload()}},{key:"render",value:function(){if(this.redirect){var e=(new Z).urlForRoot();return r.createElement(Ue.a,{to:e})}if(!this.guardInvalidState())return r.createElement(r.Fragment,null);var t=this.data.state.topic;return r.createElement("div",{className:"component--TopicHomePage"},r.createElement(ce,{user:this.props.user.state,topic:t.state,loading:this.data.updating}),r.createElement(Q,{error:this.data.state.topic.error},r.createElement(J,{value:this.data.state.notice}),r.createElement(st,{submit:this.onSubmitFormEvent,topic:t,saveText:"Save"})),r.createElement(Se,{user:this.props.user,requirePermissions:["CanDelete:Topic"]},r.createElement(A,null,r.createElement(Ce,{title:"Unsafe commands"},r.createElement("form",null,r.createElement("fieldset",null,r.createElement(V,{expand:!0},r.createElement("p",null,"Accidentally created this topic?"),r.createElement("p",null,"If it has no questions it can be deleted."),r.createElement("p",null,"Careful! No undo for this!"),r.createElement("button",{onClick:this.onDeleteTopic},"Delete topic"))))))))}},{key:"guardInvalidState",value:function(){return null!==this.data}}]),t}(r.Component),it=(n(205),function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.userVotes>0?["up","active"]:["up"],t=this.props.userVotes<0?["down","active"]:["down"],n=this.props.userStars>0?["star","active"]:["star"];return r.createElement("div",{className:"component--VotesAndStarsReadonly"},r.createElement("li",null,r.createElement("div",{className:e.join(" ")})),r.createElement("li",null,r.createElement("div",{className:"votes"},this.props.votes)),r.createElement("li",null,r.createElement("div",{className:t.join(" ")})),r.createElement("li",{className:"star-container"},r.createElement("div",{className:n.join(" ")})))}}]),t}(r.Component)),ot=(n(207),function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.question.state.meta;return r.createElement("div",{className:"component--QuestionSummaryView"},r.createElement("div",{className:"metadata"},r.createElement(it,{userStars:e.state.star?1:0,userVotes:e.state.votes,votes:e.state.global.votes})),r.createElement("div",{className:"output"},r.createElement(ie,{question:this.props.question,target:ee.View},r.createElement("h2",null,this.props.question.state.title)),r.createElement(he,{tags:this.props.question.state.tags,topic:this.props.question.state.topic}),r.createElement(H,{markdown:this.props.question.state.summary}),this.renderAnswer(),r.createElement(oe,null,r.createElement(fe,{user:this.props.question.state.user}))))}},{key:"renderAnswer",value:function(){return this.props.question.state.answer?r.createElement("div",{className:"answer"},r.createElement(H,{markdown:this.props.question.state.answer})):r.createElement(r.Fragment,null)}}]),t}(r.Component)),pt=(n(209),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).state={page:0,pageSize:10},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.createElement("div",{className:"component--QuestionSummaryList"},this.renderList())}},{key:"renderList",value:function(){return null===this.props.questions.state.instances||0===this.props.questions.state.instances.length?r.createElement(A,null,"No questions found"):this.props.questions.state.instances.map(function(e){return e.state.questionId?r.createElement(A,{key:e.state.questionId},r.createElement(ot,{question:e})):r.createElement(r.Fragment,null)})}}]),t}(r.Component)),lt=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"refresh",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchQuestionData(t.state.questionId);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{answer:null,canEdit:!1,meta:new ye,questionId:"",summary:"...",tags:[],title:"new answer",topic:"default",user:new je}}},{key:"fetchQuestionData",value:function(){var e=Object(v.a)(d.a.mark(function e(t){var n,r,a,u;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ke,e.next=3,n.getSummary(t);case 3:return r=e.sent,e.t0=ye,e.next=7,n.getMetadata(t);case 7:return e.t1=e.sent,a=new e.t0(e.t1),e.next=11,je.get(r.userId);case 11:return u=e.sent,e.abrupt("return",Object(s.a)({},r,{meta:a,user:u}));case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"rebind",value:function(){this.state.meta.parent=this}}],[{key:"get",value:function(){var e=Object(v.a)(d.a.mark(function e(n){var r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new t).state.questionId=n,e.next=4,r.refresh();case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"search",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return X.fromQuery({fetchIds:t.searchForIds,fetchInstance:t.get,pageSize:n,query:e},r)}},{key:"searchForIds",value:function(){var e=Object(v.a)(d.a.mark(function e(t,n,r){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new ke,e.next=3,a.search(t,n,r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()}]),t}(w),ht=function(e){function t(e){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).call(this,e))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"search",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{search:t});case 1:case"end":return e.stop()}},e)})));case 2:return e.next=4,this.refreshData();case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"next",value:function(){var e=Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state.questions.next();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"prev",value:function(){var e=Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state.questions.prev();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setPageSize",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{pageSize:t});case 1:case"end":return e.stop()}},e)})));case 2:return e.next=4,this.refreshData();case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"loadInitialData",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.get(t.topic);case 2:if(!(n=e.sent).error){e.next=5;break}throw n.error;case 5:return e.abrupt("return",{topic:n,search:t.search});case 6:case"end":return e.stop()}},e)})));case 2:return e.next=4,this.refreshData();case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"refreshData",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="topic:".concat(t.state.topic.state.name," ").concat(t.state.search),e.next=3,lt.search(n,t.state.pageSize);case 3:if(!(r=e.sent).error){e.next=6;break}throw r.error;case 6:return e.abrupt("return",{questions:r});case 7:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{pageSize:5,questions:new X,search:"",topic:new Y}}},{key:"rebind",value:function(){this.state.topic.parent=this,this.state.questions.parent=this}}]),t}(ge),ft=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).data=void 0,n.onSearchEvent=function(e){return n.data.search(e)},n.onChangeSize=function(e){return n.data.setPageSize(e)},n.onNext=function(){return n.data.next()},n.onPrev=function(){return n.data.prev()},n.data=new ht(function(){return n.forceUpdate()}),n.state={lastSearchProp:""},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.data.unload(),this.data=new ht(function(){return e.forceUpdate()}),this.data.load(this.props)}},{key:"componentWillUnmount",value:function(){this.data.unload()}},{key:"componentDidUpdate",value:function(e,t,n){var r=this;this.props.search!==this.state.lastSearchProp&&this.setState({lastSearchProp:this.props.search},function(){r.data.load(r.props)})}},{key:"render",value:function(){if(!this.guardInvalidState())return r.createElement(r.Fragment,null);var e=this.data.state.questions,t=this.data.state.search,n=this.data.state.topic;return r.createElement("div",{className:"component--TopicSearchPage"},r.createElement(ce,{user:this.props.user.state,topic:n.state,loading:this.data.updating}),r.createElement(Ye,{error:this.data.error,value:t,onChange:this.onSearchEvent}),r.createElement(pt,{questions:e}),r.createElement(Ge,{allowedSizes:[1,5,10,25],queryState:e.state,onChangeSize:this.onChangeSize,onNext:this.onNext,onPrev:this.onPrev,error:e.error}),r.createElement(A,null,r.createElement(V,{expand:!0},r.createElement(te,{target:N.AddQuestion,topic:this.props.topic},r.createElement("button",null,"Ask question")))))}},{key:"guardInvalidState",value:function(){return null!==this.data}}]),t}(r.Component),dt=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"next",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.state.starQuestions.next();case 2:return e.abrupt("return",null);case 3:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"prev",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.state.starQuestions.prev();case 2:return e.abrupt("return",null);case 3:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setPageSize",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{pageSize:t});case 1:case"end":return e.stop()}},e)})));case 2:return e.next=4,this.refreshData();case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"loadInitialData",value:function(){var e=Object(v.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.refreshData();case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"blank",value:function(){return{pageSize:5,starQuestions:new X}}},{key:"rebind",value:function(){this.state.starQuestions.parent=this}},{key:"refreshData",value:function(){var e=Object(v.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update(Object(v.a)(d.a.mark(function e(){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lt.search("* topic:* is:star",t.state.pageSize);case 2:return n=e.sent,e.abrupt("return",{starQuestions:n});case 4:case"end":return e.stop()}},e)})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}(ge),vt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).data=void 0,n.onChangeSize=function(e){return n.data.setPageSize(e)},n.onNext=function(){return n.data.next()},n.onPrev=function(){return n.data.prev()},n.data=new dt(function(){return n.forceUpdate()}),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.data.unload(),this.data=new dt(function(){return e.forceUpdate()}),this.data.load(this.props)}},{key:"componentWillUnmount",value:function(){this.data.unload()}},{key:"render",value:function(){if(!this.guardInvalidState())return"";var e=this.data.state.starQuestions;return r.createElement("div",{className:"component--TopicHomePage"},r.createElement(ce,{user:this.props.user.state,topic:null,loading:this.data.updating}),r.createElement("div",null,r.createElement(A,null,r.createElement("h3",null,"Marked questions")),r.createElement(pt,{questions:e}),r.createElement(Ge,{allowedSizes:[1,5,10,25],queryState:e.state,onChangeSize:this.onChangeSize,onNext:this.onNext,onPrev:this.onPrev,error:e.error})))}},{key:"guardInvalidState",value:function(){return null!==this.data}}]),t}(r.Component),mt=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return(n=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).help=function(){return r.createElement(Pe,null)},n.logout=function(){return r.createElement(Ae,{user:n.props.user})},n.self=function(){return r.createElement(vt,{user:n.props.user})},n.discoverTopics=function(){return r.createElement(nt,{user:n.props.user,search:"*"})},n.searchTopicWithQuery=function(e){return r.createElement(ft,{user:n.props.user,topic:e.match.params.name,search:e.match.params.query})},n.searchTopic=function(e){return r.createElement(ft,{user:n.props.user,topic:e.match.params.name,search:"*"})},n.editTopic=function(e){return r.createElement(ct,{user:n.props.user,topic:e.match.params.name})},n.askQuestion=function(e){return r.createElement(Me,{user:n.props.user,topic:e.match.params.name})},n.viewQuestion=function(e){return r.createElement($e,{user:n.props.user,topic:e.match.params.name,question:e.match.params.questionId})},n.editQuestion=function(e){return r.createElement(Be,{user:n.props.user,topic:e.match.params.name,question:e.match.params.questionId})},n.editAnswer=function(e){return r.createElement(Te,{user:n.props.user,topic:e.match.params.name,question:e.match.params.questionId,answer:e.match.params.answerId})},n.answerQuestion=function(e){return r.createElement(qe,{user:n.props.user,topic:e.match.params.name,question:e.match.params.questionId})},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.createElement(l.a,null,r.createElement(h.a,null,r.createElement(M.a,{exact:!0,path:"/",render:this.discoverTopics}),r.createElement(M.a,{exact:!0,path:"/help",render:this.help}),r.createElement(M.a,{exact:!0,path:"/self",render:this.self}),r.createElement(M.a,{exact:!0,path:"/logout",render:this.logout}),r.createElement(M.a,{exact:!0,path:"/t/:name",render:this.searchTopic}),r.createElement(M.a,{exact:!0,path:"/t/:name/search/:query",render:this.searchTopicWithQuery}),r.createElement(M.a,{exact:!0,path:"/t/:name/edit",render:this.editTopic}),r.createElement(M.a,{exact:!0,path:"/t/:name/ask",render:this.askQuestion}),r.createElement(M.a,{exact:!0,path:"/t/:name/:questionId",render:this.viewQuestion}),r.createElement(M.a,{exact:!0,path:"/t/:name/:questionId/edit",render:this.editQuestion}),r.createElement(M.a,{exact:!0,path:"/t/:name/:questionId/answer",render:this.answerQuestion}),r.createElement(M.a,{exact:!0,path:"/t/:name/:questionId/answer/:answerId/edit",render:this.editAnswer})))}}]),t}(r.Component),bt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).showLoginForm=function(){return r.createElement(L,{user:n.state.user})},n.showContent=function(){return n.props.settings.test.test?n.showTestContent():n.showMainContent()},n.showMainContent=function(){return r.createElement(mt,{user:n.state.user})},n.showTestContent=function(){return null==n.props.settings.test.testContent?r.createElement(r.Fragment,null):r.createElement(l.a,null,r.createElement(h.a,null,n.props.settings.test.testContent(n.state.user)))},n.state={user:new j},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e;e=this.props.settings,S.configure(new E(e.backendUrl)),y.configure(function(){return new q}),I.configure(e)}},{key:"render",value:function(){return r.createElement(O,null,r.createElement(z,{user:this.state.user,renderLoggedIn:this.showContent,renderLoggedOut:this.showLoginForm}))}}]),t}(r.Component),wt=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return(n=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).testContent=function(e){return r.createElement(r.Fragment,null,r.createElement(vt,{user:e}))},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=Object(s.a)({},this.props.settings,{textContent:this.testContent});return r.createElement(bt,{settings:e})}}]),t}(r.Component),jt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ot(){if("serviceWorker"in navigator){if(new URL("",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("","/service-worker.js");jt?(!function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):kt(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):kt(e)})}}function kt(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}new E("/").get("config.json").then(function(e){a.render(r.createElement(wt,{settings:e}),document.getElementById("root")),Ot()})},70:function(e,t,n){e.exports=n(211)},77:function(e,t,n){},81:function(e,t,n){},83:function(e,t,n){},85:function(e,t,n){},87:function(e,t,n){},89:function(e,t,n){},91:function(e,t,n){}},[[70,2,1]]]);
//# sourceMappingURL=main.fba431d7.chunk.js.map